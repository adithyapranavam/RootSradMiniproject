
<main class="main">
    <%- include('../partials/userheader.ejs')%>
    <nav aria-label="breadcrumb" class="breadcrumb-nav border-0 mb-0">
        <div class="container d-flex align-items-center">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                <li class="breadcrumb-item active" aria-current="page">Default</li>
            </ol>
        </div>
    </nav>

    <div class="page-content">
        <div class="container">
            <div class="product-details-top">
                <div class="row">
                    <div class="col-md-6">
                        <div class="product-gallery product-gallery-vertical">
                            <div class="row">
                                <figure class="product-main-image">
                                    
                                    <img id="product-zoom" src="/productImages/<%= data.image[0]%>"
                                     data-zoom-image="/productImages/<%= data.image[1]%>"alt="product image">
                                
                                    <a href="#" id="btn-product-gallery" class="btn-product-gallery">
                                        <i class="icon-arrows"></i>
                                    </a>
                                </figure>

                                <div id="product-zoom-gallery" class="product-image-gallery">
                                    <a class="product-gallery-item active" href="#" 
                                    data-image="/productImages/<%= data.image[0]%>" 
                                    data-zoom-image="/productImages/<%= data.image[0]%>">
                                    <img src="/productImages/<%= data.image[0]%>" alt="product side">
                                    </a>

                                    <a class="product-gallery-item " href="#" 
                                    data-image="/productImages/<%= data.image[2]%>" 
                                    data-zoom-image="/productImages/<%= data.image[2]%>">
                                        <img src="/productImages/<%= data.image[2]%>" alt="product cross">
                                    </a>

                                    <a class="product-gallery-item " href="#" 
                                    data-image="/productImages/<%= data.image[3]%>" 
                                    data-zoom-image="/productImages/<%= data.image[3]%>">
                                        <img src="/productImages/<%= data.image[3]%>" alt="product with model">
                                    </a>
                                    <a class="product-gallery-item " href="#" 
                                    data-image="/productImages/<%= data.image[1]%>" 
                                    data-zoom-image="/productImages/<%= data.image[1]%>">
                                        <img src="/productImages/<%= data.image[1]%>" alt="product with model">
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
        
                    <div class="col-md-6">
                        <div class="product-details">
                            <h1 class="product-title"><%= data.name %></h1><!-- End .product-title -->

                            <div class="ratings-container">
                                <div class="ratings">
                                    <div class="ratings-val" style="width: 80%;"></div><!-- End .ratings-val -->
                                </div><!-- End .ratings -->
                                <a class="ratings-text" href="#product-review-link" id="review-link">( 10 Reviews )</a>
                            </div>
                            <div class="product-price">
                               <span class="orginalprice">₹<%= data.price %></span> &nbsp;&nbsp;
                               <span class="old-price" style="text-decoration: line-through;">₹ <%= data.orginalprice %></span>
                            </div>

                            <div class="product-content">
                                <p> <%= data.discription %></p>
                            </div><!-- End .product-content -->

                          
                            <div class="details-filter-row details-row-size">
                                <label for="qty">Qty:</label>
                                <div class="product-details-quantity">
                                    <input type="number" id="qty" class="form-control" value="1" min="1" max="10" step="1" data-decimals="0" required>
                                </div><!-- End .product-details-quantity -->
                            </div><!-- End .details-filter-row -->

                           
                            <div class="product-details-action">
                                <%if(user){%>
                                    <form action="" method="post" id="CartForm">
                                        <input type="hidden" value="<%= data._id%>" id="cartProductId">
                                       <button class="btn-product btn-cart add-to-cart"><span>Add to Cart</span></button>
                                    </form>
                                  

                                    <!-- <form action="" method="get" id="WhishList">
                                        <input type="hidden" value="<%= data._id%>" id="whishlistProductId">
                                       <button   class="btn-product btn-wishlist"><span>Add to Wishlist</span></button>
                                    </form> -->
                                    <%}else{%>
                                            <form action="/login" method="get" id="CartForm">
                                                <input type="hidden" value="<%= data._id%>" id="cartProductId">
                                           <button class="btn-product btn-cart add-to-cart"><span>Add to Cart</span></button>
                                        </form>
                                      
                                        <!-- <form action="/login" method="get" id="WhishList">
                                            <input type="hidden" value="<%= data._id%>" id="cartProductId">
                                           <button   class="btn-product btn-wishlist"><span>Add to Wishlist</span></button>
                                        </form> -->
                                        <%}%>
                            </div>
                            <p id="CartSuccMsg"></p>
                            <div class="pt-3">
                                <div class="border border-dark p_Delivery_Border" style="max-width: 350px;">
                                    <div class="d-flex align-items-center p-3 gap-3">
                                        <img class="img-fluid" src="/assetsmain/images/water.jpeg" alt=""
                                            style="width:40px">
                                        <h7>Water Once A Week</h7>
                                    </div>
                                    <hr class="p-0 m-0 bg-dark">
                                    <div class="d-flex align-items-center p-3 gap-3">
                                        <img class="img-fluid" src="/assetsmain/images/sunlight.png" alt=""
                                            style="width:40px">
                                        <h7>Needs Medium To Low Light</h7>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="product-details-tab">
                <ul class="nav nav-pills justify-content-center" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="product-desc-link" data-toggle="tab" href="#product-desc-tab" role="tab" aria-controls="product-desc-tab" aria-selected="true">Description</a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" id="product-review-link" data-toggle="tab" href="#product-review-tab" role="tab" aria-controls="product-review-tab" aria-selected="false">Reviews (10)</a>
                    </li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane fade show active" id="product-desc-tab" role="tabpanel" aria-labelledby="product-desc-link">
                        <div class="product-desc-content">
                            <h3>Product Information</h3>
                           <%= data.discription %>
                       </div>
                    </div>
                 
                 
                    <div class="tab-pane fade" id="product-review-tab" role="tabpanel" aria-labelledby="product-review-link">
                        <div class="reviews">
                            <h3>Reviews (10)</h3>
                            <div class="review">
                                <div class="row no-gutters">
                                    <div class="col-auto">
                                        <h4><a href="#">Samanta J.</a></h4>
                                        <div class="ratings-container">
                                            <div class="ratings">
                                                <div class="ratings-val" style="width: 80%;"></div><!-- End .ratings-val -->
                                            </div><!-- End .ratings -->
                                        </div><!-- End .rating-container -->
                                        <span class="review-date">6 days ago</span>
                                    </div><!-- End .col -->
                                    <div class="col">
                                        <h4>Good, perfect size</h4>

                                        <div class="review-content">
                                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ducimus cum dolores assumenda asperiores facilis porro reprehenderit animi culpa atque blanditiis commodi perspiciatis doloremque, possimus, explicabo, autem fugit beatae quae voluptas!</p>
                                        </div><!-- End .review-content -->

                                        <div class="review-action">
                                            <a href="#"><i class="icon-thumbs-up"></i>Helpful (2)</a>
                                            <a href="#"><i class="icon-thumbs-down"></i>Unhelpful (0)</a>
                                        </div><!-- End .review-action -->
                                    </div><!-- End .col-auto -->
                                </div><!-- End .row -->
                            </div><!-- End .review -->

                            <div class="review">
                                <div class="row no-gutters">
                                    <div class="col-auto">
                                        <h4><a href="#">John Doe</a></h4>
                                        <div class="ratings-container">
                                            <div class="ratings">
                                                <div class="ratings-val" style="width: 100%;"></div><!-- End .ratings-val -->
                                            </div><!-- End .ratings -->
                                        </div><!-- End .rating-container -->
                                        <span class="review-date">5 days ago</span>
                                    </div><!-- End .col -->
                                    <div class="col">
                                        <h4>Very good</h4>

                                        <div class="review-content">
                                            <p>Sed, molestias, tempore? Ex dolor esse iure hic veniam laborum blanditiis laudantium iste amet. Cum non voluptate eos enim, ab cumque nam, modi, quas iure illum repellendus, blanditiis perspiciatis beatae!</p>
                                        </div><!-- End .review-content -->

                                        <div class="review-action">
                                            <a href="#"><i class="icon-thumbs-up"></i>Helpful (0)</a>
                                            <a href="#"><i class="icon-thumbs-down"></i>Unhelpful (0)</a>
                                        </div><!-- End .review-action -->
                                    </div><!-- End .col-auto -->
                                </div><!-- End .row -->
                            </div><!-- End .review -->
                        </div><!-- End .reviews -->
                    </div><!-- .End .tab-pane -->
                </div>
            </div>

            <h2 class="title text-center mb-4">You May Also Like</h2>

            <div class="owl-carousel owl-simple carousel-equal-height carousel-with-shadow" data-toggle="owl" 
            data-owl-options='{
                "nav": false, 
                "dots": true,
                "margin": 20,
                "loop": false,
                "responsive": {
                    "0": {
                        "items":1
                    },
                    "480": {
                        "items":2
                    },
                    "768": {
                        "items":3
                    },
                    "992": {
                        "items":4
                    },
                    "1200": {
                        "items":4,
                        "nav": true,
                        "dots": false
                    }
                }
            }'>
            <% category.forEach((data,index)=>{%>
            <div class="product product-7 text-center">
                <figure class="product-media">
                    <a href="">
                        <img src="/productImages/<%= data.image[0]%>" alt="Product image" class="product-image">
                    </a>
                    <div class="product-action-vertical">
                        <a href="#" class="btn-product-icon btn-wishlist btn-expandable"><span>add to wishlist</span></a>
                    </div>
                    <div class="product-action">
                        <a href="#" class="btn-product btn-cart"><span>add to cart</span></a>
                    </div>
                </figure>
                <div class="product-body">
                    <h3 class="product-title"><a href="product.html"><%=data.name %></a></h3>
                    <div class="product-price">
                        <span class="new-price">₹ <%= data.price %></span>
                        <span class="old-price" style="text-decoration: line-through;">₹ <%= data.orginalprice %></span>
                    </div>
                    <div class="ratings-container">
                        <div class="ratings">
                            <div class="ratings-val" style="width: 20%;"></div>
                        </div>
                        <span class="ratings-text">( 2 Reviews )</span>
                    </div>
                </div>
            </div>
            <%})%>    
        </div>
    </div>
</main> 

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const form = document.getElementById('CartForm');
        const succMsg = document.getElementById('CartSuccMsg');
        const cartItemCount = document.getElementById('cartItemCount');
        form.addEventListener('submit', (event) => {
            event.preventDefault();
            $.ajax({
                type: 'post',
                url: '/cart/<%= data._id%>',
                success: function (res) {
                    succMsg.textContent = "Product Successfully Added Your Cart"
                    setTimeout(() => {
                       succMsg.style.display = 'none';
                       }, 2000);
                    const currentCount = parseInt(cartItemCount.textContent) || 0;
                    const newCount = currentCount + 1;
                    cartItemCount.textContent = newCount;
                }
            })
  
        })
    })
  </script> 


<%- include('../partials/userfooter.ejs') %>
